<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE mapper PUBLIC '-//mybatis.org//DTD Mapper 3.0//EN'
        'http://mybatis.org/dtd/mybatis-3-mapper.dtd'>

<mapper namespace='cat.xarxarepublicana.hashtagsxrep.infrastructure.repository.jdbc.mapper.GroupMapper'>

    <resultMap id='GroupResultMap' type="cat.xarxarepublicana.hashtagsxrep.domain.group.Group">
        <constructor>
            <idArg column="id" javaType="string" />
        </constructor>
    </resultMap>

    <select id="selectGroupToAddNextUser" resultMap="GroupResultMap">
        select membership.group_id, count(membership.user_id) as users_count from USER_MEMBERSHIP membership
        group by membership.group_id
        having users_count &lt;&gt; 48
        order by 2 desc
        limit 1
    </select>

</mapper>